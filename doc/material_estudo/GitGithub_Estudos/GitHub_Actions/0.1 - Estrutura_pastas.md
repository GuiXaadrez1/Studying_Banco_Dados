# IntroduÃ§Ã£o 
Este documento visa explicar como funciona a estrtura de diretÃ³rios(pasta) para podermos 
fazer o nosso Github Action

## ğŸ“‚ Estrutura correta da pasta .github

Regra principal: 
    A pasta .github DEVE estar na raiz do repositÃ³rio se vocÃª quer que o GitHub Actions reconheÃ§a seus workflows automaticamente.

Exemplo: 

```bash
meu-projeto/
 â”œâ”€â”€ .github/
 â”‚    â””â”€â”€ workflows/
 â”‚         â”œâ”€â”€ ci.yml
 â”‚         â”œâ”€â”€ deploy.yml
 â”œâ”€â”€ src/
 â”œâ”€â”€ package.json
 â””â”€â”€ README.md
```

### Por que?
O GitHub procura automaticamente os arquivos YAML dentro de:

```bash
<raiz do repositÃ³rio>/.github/workflows/
```

Se vocÃª colocar em uma subpasta como:

```bash
meu-projeto/src/.github/workflows/
```

ou

```bash
meu-projeto/.github/ci/workflows/
```

NÃƒO FUNCIONA!

O GitHub ignora â€” ele nÃ£o â€œprocuraâ€ em subpastas, ele espera exatamente: .github/workflows/.

## O que pode estar dentro da pasta .github

A pasta .github pode conter:

| Pasta/Arquivo                      | FunÃ§Ã£o                                        |
| ---------------------------------- | --------------------------------------------- |
| `.github/workflows/`               | ContÃ©m **workflows YAML** do Actions          |
| `.github/ISSUE_TEMPLATE/`          | Templates de **issues**                       |
| `.github/PULL_REQUEST_TEMPLATE.md` | Template de **pull request**                  |
| `.github/FUNDING.yml`              | Configura botÃ£o de doaÃ§Ã£o                     |
| `.github/CODEOWNERS`               | Define **quem revisa** quais partes do cÃ³digo |

## Estrutura detalhada de um workflow

ğŸ“„ Arquivo: .github/workflows/ci.yml

```yaml
name: CI Pipeline

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:
  schedule:
    - cron: '0 3 * * *'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout do cÃ³digo
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Instala dependÃªncias
        run: npm install

      - name: Roda testes
        run: npm test

  deploy:
    runs-on: ubuntu-latest
    needs: build # SÃ³ roda se 'build' tiver sucesso
    steps:
      - name: Deploy fictÃ­cio
        run: echo "Deploy OK!"

```

Vamos analisar bloco por bloco, com exemplos didÃ¡ticos e explicaÃ§Ã£o linha por linha.

### name

```yaml
name: CI Pipeline
```

Ã‰ opcional, mas recomendado.

Define como o workflow aparece na aba Actions do repositÃ³rio.

### on

```yaml
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:
  schedule:
    - cron: '0 3 * * *'

```

push âœ Roda quando alguÃ©m faz push.

pull_request âœ Roda em PRs abertos para main.

workflow_dispatch âœ Permite rodar manual pelo botÃ£o Run workflow.

schedule âœ Executa automaticamente em horÃ¡rios fixos (cron).

### jobs

Um workflow pode ter um ou vÃ¡rios jobs.
Cada job Ã© independente (a menos que use needs:).

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout do cÃ³digo
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Instala dependÃªncias
        run: npm install

      - name: Roda testes
        run: npm test

  deploy:
    runs-on: ubuntu-latest
    needs: build # SÃ³ roda se 'build' tiver sucesso
    steps:
      - name: Deploy fictÃ­cio
        run: echo "Deploy OK!"
```

**Dentro de jobs:**

| Campo      | O que faz                                                 |
| ---------- | --------------------------------------------------------- |
| `runs-on:` | Qual mÃ¡quina virtual vai executar (Ubuntu, Windows, Mac). |
| `steps:`   | Lista de comandos ou aÃ§Ãµes que rodam em sequÃªncia.        |
| `needs:`   | Define **dependÃªncia entre jobs**.                        |
| `env:`     | Define variÃ¡veis de ambiente globais para o job.          |

**Dentro de steps:**

Cada step Ã© um bloco de execuÃ§Ã£o:

- Executa um comando direto (run:)

- Ou usa uma aÃ§Ã£o pronta (uses:)

- Pode ter with: para passar parÃ¢metros.

```yaml
steps:
  - name: Checkout
    uses: actions/checkout@v4

  - name: Instala dependÃªncias
    run: npm install

  - name: Build
    run: npm run build

  - name: Deploy para S3
    uses: jakejarvis/s3-sync-action@master
    with:
      args: --acl public-read --delete
    env:
      AWS_S3_BUCKET: ${{ secrets.AWS_S3_BUCKET }}
      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
      AWS_REGION: 'us-east-1'

```

## VariÃ¡veis, Secrets e Contextos

- âœ… env: â€” VariÃ¡veis de ambiente globais ou locais (por job, por step).
- âœ… secrets â€” SÃ£o valores seguros, como tokens de API. VocÃª guarda no GitHub â†’ Settings > Secrets.
- âœ… Contextos â€” ${{ secrets.MINHA_SECRET }} ou ${{ github.ref }}.

Exemplo:

```yaml
env:
  NODE_ENV: production

# Usando secret:
AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}

```

## Onde o GitHub Actions executa

Cada job roda numa mÃ¡quina virtual descartÃ¡vel.
VocÃª nÃ£o precisa configurar servidor de build â†’ o GitHub hospeda pra vocÃª.

## Checklist Final

âœ”ï¸ .github/workflows DEVE estar na raiz do projeto.
âœ”ï¸ MÃºltiplos YAMLs = mÃºltiplos workflows.
âœ”ï¸ on: define quando dispara.
âœ”ï¸ jobs: define o que fazer.
âœ”ï¸ Cada job = VM separada.
âœ”ï¸ steps = aÃ§Ãµes + comandos shell.